---
title: "HW3: Control Flow Practice and Function Writing"
author: "Naomi Novick"
format: html
editor: visual
---

Setting up environment
```{r}
load("hw2_list.rda")
```

## Task 1: Control Flow Practice

### We want to characterize the post treatment/placebo blood pressure measurement as optimal, borderline, and high

Create new blank columns in the treatment and placebo dataframes
```{r}
bp_list$treatment$status <- character(20)
bp_list$placebo$status <- character(10)
```


Rewrite the blank columns in the treatment dataframe
```{r}
for(i in 1:20){
  if(bp_list$treatment$post_bp[i] <= 120){
    bp_list$treatment$status[i] <- "optimal"
  } else if(bp_list$treatment$post_bp[i] > 130){
    bp_list$treatment$status[i] <- "high"
  } else{
    bp_list$treatment$status[i] <- "borderline"
  }
}
```

Rewrite the blank columns in the placebo dataframe
```{r}
for(i in 1:10){
  if(bp_list$placebo$post_bp[i] <= 120){
    bp_list$placebo$status[i] <- "optimal"
  } else if(bp_list$placebo$post_bp[i] > 130){
    bp_list$placebo$status[i] <- "high"
  } else{
    bp_list$placebo$status[i] <- "borderline"
  }
}
```


## Task 2: Function Writing

Returns a vector of statitistics of interest for each of the numeric columns in each dataframe of a list

```{r}
get_summary_stat <- function(df_list, func = "mean"){
  my_df <- df_list
  # gets a funciton from the quoted string arguement
  my_fun <- get(func)
 
  # Creating df with only the numeric columns 
  for(i in 1:length(my_df)){
    my_df[[i]] <- my_df[[i]][sapply(my_df[[i]], is.numeric)]
  }
  
  # Creating meaningful names vector
  meaningful_names <- c()
  for(i in 1:length(my_df)){
    meaningful_names <- c(meaningful_names, paste(names(my_df[i]), names(my_df[[i]]), func, sep = ":"))
  }
  
  # Created summary statistic
  summary_stat <- c()
  for(i in 1:length(my_df)){
    summary_stat <- c(summary_stat, apply(my_df[[i]], 2, my_fun))
  }
  
  names(summary_stat) <- meaningful_names
  
  return(summary_stat)
}
```

Applying the above function to the given bp_list. It will be used without specifying
the statistic and with specifying the statistic as "var", "sd", "min", and "max".
```{r}
get_summary_stat(bp_list)
get_summary_stat(bp_list, "var")
get_summary_stat(bp_list, "sd")
get_summary_stat(bp_list, "min")
get_summary_stat(bp_list, "max")
```




